/*
* Core js fw functions
* Do not edit this file 
*/

/* 
 * Set body Id for Layers js/css
 */
$('body').attr('id', 'layers-body');


/* 
 * Init app on page loaded (supports ie11+)
 */
function mgLoadPageContoler(){
    new Promise(function(resolve, reject) {
        var ret = mgJsComponentHandler.registerComponents();
        if (ret || !ret) {
            resolve(ret);
        }
    }).then(function(resault) {
        var appContainers = document.getElementsByClassName("vue-app-main-container");
        ret = mgEventHandler.runCallback('AppsPreLoad', null, {appContainers: appContainers});
        return ret;
    }).then(function(resault) {
        var appContainers = document.getElementsByClassName("vue-app-main-container");
        for (var i = 0; i < appContainers.length; i++) {
            mgPageControler = new mgVuePageControler(appContainers[i].id);
            mgPageControler.vinit();
        }
    });
};

document.onreadystatechange = function () {
    if (document.readyState === "interactive") {
        mgLoadPageContoler();
    }
};


/* 
 * Url Helper
 */
var mgUrlParser = {
    url: null,
    
    getCurrentUrl: function(){
        if(!this.url){
            if(window.location.href.indexOf('#') > 0){
                this.url = window.location.href.substr(0, window.location.href.indexOf('#'));
            }else{
                this.url = window.location.href;
            }       
        }
        
        return this.url;
    },

    getUrlParam: function (key, defaultValue){
        var url = this.getCurrentUrl();
        var paramsString = url.substr(url.indexOf('?') + 1);
        var params = paramsString.split('&');
        var paramsContainer = {};
        $.each(params, function( index, value ) {
            var param = value.split('=');
            paramsContainer[param[0]] = param[1];
        });

        if (paramsContainer.hasOwnProperty(key)) {
            return paramsContainer[key];
        } else {
            return defaultValue;
        }
    }
};

/*
 * A redirect function for provisioning product configuration page
 */
function redirectToConfigurableOptions()
{
    var url = mgUrlParser.oldMgUrlParser.getCurrentUrl() + '&tab=5';
    url = url.replace("&tab=3", "").replace("&success=true", "");
    window.location.replace(url);
}
